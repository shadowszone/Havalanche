<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WalletConnect Test</title>
  <script src="https://cdn.jsdelivr.net/npm/@walletconnect/client@2.0.0-beta.10/dist/umd/index.min.js"></script>
</head>
<body>
  <button id="connectButton">Connect Wallet</button>

  <script>
    // Initialize WalletConnect
    const walletConnect = new WalletConnect.Client({
      bridge: "https://bridge.walletconnect.org", // WalletConnect Bridge URL
    });

    // Button to trigger wallet connection
    document.getElementById('connectButton').addEventListener('click', async () => {
      alert("Attempting to connect to the wallet...");

      try {
        // Check if the client is already connected
        if (!walletConnect.connected) {
          alert("No existing connection, creating new one...");
          
          // Create a new WalletConnect session
          await walletConnect.connect();

          // Display a QR Code for the user to scan with their wallet app
          alert("Scan the QR Code with your wallet app!");
          walletConnect.createSession().then(() => {
            const uri = walletConnect.uri;
            alert("WalletConnect URI: " + uri);
            // You can display the URI as a QR code, for example:
            // document.getElementById('qrCode').innerHTML = '<img src="https://api.qrserver.com/v1/create-qr-code/?data=' + encodeURIComponent(uri) + '" alt="QR Code" />';
          });
        } else {
          alert("Already connected!");
        }
        
        // Listen for the connection event
        walletConnect.on("connect", (error, payload) => {
          if (error) {
            alert("Error connecting: " + error);
            return;
          }
          alert("Wallet connected!");
          const { accounts, chainId } = payload.params[0];
          alert("Connected address: " + accounts[0]);
          alert("Connected to chain ID: " + chainId);
        });

        // Listen for the disconnection event
        walletConnect.on("disconnect", (error, payload) => {
          if (error) {
            alert("Error disconnecting: " + error);
            return;
          }
          alert("Wallet disconnected!");
        });
      } catch (error) {
        alert("Error during connection attempt: " + error.message);
      }
    });
  </script>

  <!-- Optional: Display a QR code if you want to show it on the page -->
  <!-- <div id="qrCode"></div> -->
</body>
</html>
